#!/usr/bin/python
#Name Lookup For IP Lists
#Version 1.0
#Author: Jacques Coetzee
#2017

import subprocess,sys,os

scriptfile = os.path.basename(__file__)



dnsserver=''
if len(sys.argv) > 1:
	if "-dns=" in sys.argv[1]:
		dnsserver = sys.argv[1].split('=')[1].strip()

if not sys.stdin.isatty():
	result = open("%s.output" % scriptfile, "w" )
	for ip in sys.stdin:
		ip = ip.strip()
		if dnsserver == '':
			nslookup="nslookup %s | grep name" % (ip.strip())
			print 'Hit'
			print nslookup
		else:
			nslookup="nslookup %s %s | grep name" % (ip.strip(),dnsserver)
		try:
				nslookupresult = subprocess.check_output(nslookup, shell=True).split("\n")
				for line in nslookupresult:
						if line != '':
								a = line.split()
								if len(a) == 4:
										print ip,a[3]
										dnsresults.write("%s %s\n" % (ip.strip(),a[3]))
		except:
				print ip.strip(), "No reverse found"
				result.write("%s %s\n" % (ip.strip(), "No reverse found"))

	result.close()




