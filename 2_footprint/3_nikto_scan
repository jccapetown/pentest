#!/usr/bin/python

import subprocess
import sys,os
from netaddr import *

os.system('clear')
print '''Footprinting::Active::Nikto Scan.
Description: Provide a IP for scan.
			'''

#Check to see if the script runs as root
if not os.geteuid() == 0:
	sys.exit('Script must be run as root')

savefolder = '/tmp/' + sys.argv[0] + '_results'
if not os.path.exists(savefolder):
  os.system('mkdir %s '% savefolder)

ip = raw_input("IP address to scan: ")

#Run Nikto
niktocommand="nikto -h %s -output %s/%s.csv" % (ip, savefolder, ip)
result = subprocess.check_output(niktocommand, shell=True)

output = "%s/%s.csv" % (savefolder, ip)

#Open and close the saved file and read each line
#f = open(output, 'rb')
#lines = f.readlines()
#f.close()	

#for line in lines:
#	if line.strip() != '':
#		lst = line.strip().split(',')
#		print lst
#		while len(lst) != 7:
#			lst.append('')	
#		IP, Name, Port, OSVDB, Type, URL, Content = lst
#		print '%s,%s,%s,%s,%s,%s,%s' % (IP, Name, Port, OSVDB, Type, URL, Content)
