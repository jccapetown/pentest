#!/usr/bin/python

import subprocess
import sys,os
from netaddr import *

os.system('clear')
print '''Footprinting::Active::DNSRecon Scan.
Description: Provide a domain name for a scan.
			'''

#Check to see if the script runs as root
if not os.geteuid() == 0:
	sys.exit('Script must be run as root')

savefolder = '/tmp/' + sys.argv[0] + '_results'
if not os.path.exists(savefolder):
  os.system('mkdir %s '% savefolder)

domain = raw_input("Domain name to scan: ")

#Run the dnsrecon
dnsreconcommand="dnsrecon -d %s -t std --csv %s/%s.csv" % (domain, savefolder, domain)
result = subprocess.check_output(dnsreconcommand, shell=True)

output = "%s/%s.csv" % (savefolder, domain)

#Open and close the saved file and read each line
f = open(output, 'rb')
lines = f.readlines()
f.close()	

for line in lines:
	if line.strip() != '':
		lst = line.strip().split(',')
		while len(lst) != 6:
			lst.append('')	
		Type, Name, Address, Target, Port, String = lst
		print '%s,%s,%s,%s,%s,%s' % (Type, Name, Address, Target, Port, String)
